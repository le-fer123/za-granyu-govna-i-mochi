
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.3/dropzone.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<div style="text-align: center">
    <form action="{% url 'filepostview' %}" method="POST" enctype="multipart/form-data" class="dropzone" id="my-dropzone">
        {% csrf_token %}
        <div class="form-group">
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" class="form-control" />
        </div>
        <div class="form-group">
            <label for="text">Text:</label>
            <textarea id="text" name="data" rows="5" class="form-control"></textarea>
        </div>
        <div class="fallback">
            <input name="file" type="file" multiple />
        </div>
    </form>
</div>

<script>
Dropzone.options.myDropzone = {
    paramName: "file",
    maxFilesize: 50,
    uploadMultiple: false,
    parallelUploads: 1,
    autoProcessQueue: true,
    init: function() {
        var myDropzone = this;

        this.on("sending", function(file, xhr, formData) {
            formData.append("title", document.getElementById("title").value);
            formData.append("data", document.getElementById("text").value);
        });

        this.on("uploadprogress", function(file, progress, bytesSent) {
            console.log("Прогресс загрузки: " + progress.toFixed(2) + "%");
        });

        this.on("success", function(file, response) {
            console.log("Файл успешно загружен");
        });

        this.on("error", function(file, errorMessage) {
            console.error("Ошибка загрузки файла: " + errorMessage);
        });
    }
};
</script>

